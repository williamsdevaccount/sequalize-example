{"version":3,"sources":["../../src/services/service.js"],"names":["Service","constructor","store","bindAll","id","v4","pathId","req","get","params","save","res","next","newData","body","set","then","data","json","catch","e","all","update","current","Object","assign","delete","deleted","sendStatus"],"mappings":";;;;;;AACA;;;;AACA;;;;;;AAGe,MAAMA,OAAN,CAAa;AACxBC,gBAAYC,KAAZ,EAAkB;AACd,aAAKA,KAAL,GAAaA,KAAb;AACA,yBAAEC,OAAF,CAAU,IAAV,EAAe,CAAC,MAAD,EAAQ,KAAR,EAAc,KAAd,EAAoB,QAApB,EAA6B,QAA7B,CAAf;AACH;AACD,WAAOC,EAAP,GAAW;AACP,eAAO,eAAKC,EAAL,EAAP;AACH;AACD,WAAOC,MAAP,CAAcC,MAAM,EAApB,EAAuB;AACnB,eAAO,iBAAEC,GAAF,CAAMD,IAAIE,MAAV,EAAiB,IAAjB,EAAsB,EAAtB,CAAP;AACH;AACDC,SAAKH,GAAL,EAASI,GAAT,EAAaC,IAAb,EAAkB;AACd,YAAIC,UAAUN,IAAIO,IAAlB;AACA,yBAAEC,GAAF,CAAMF,OAAN,EAAc,IAAd,EAAmBb,QAAQI,EAAR,EAAnB;AACA,eAAO,KAAKF,KAAL,CAAWQ,IAAX,CAAgBG,OAAhB,EACFG,IADE,CACGC,QAAO;AAACN,gBAAIO,IAAJ,CAASD,IAAT;AAAe,SAD1B,EAEFE,KAFE,CAEIC,KAAI;AAACR,iBAAKQ,CAAL;AAAS,SAFlB,CAAP;AAGH;AACDC,QAAId,GAAJ,EAAQI,GAAR,EAAYC,IAAZ,EAAiB;AACb,eAAO,KAAKV,KAAL,CAAWmB,GAAX,GACFL,IADE,CACGC,QAAO;AAACN,gBAAIO,IAAJ,CAASD,IAAT;AAAe,SAD1B,EAEFE,KAFE,CAEIC,KAAI;AAACR,iBAAKQ,CAAL;AAAS,SAFlB,CAAP;AAGH;AACDZ,QAAID,GAAJ,EAAQI,GAAR,EAAYC,IAAZ,EAAiB;AACb,eAAO,KAAKV,KAAL,CAAWM,GAAX,CAAeR,QAAQM,MAAR,CAAeC,GAAf,CAAf,EACFS,IADE,CACGC,QAAO;AAACN,gBAAIO,IAAJ,CAASD,IAAT;AAAe,SAD1B,EAEFE,KAFE,CAEIC,KAAI;AAACR,iBAAKQ,CAAL;AAAS,SAFlB,CAAP;AAGH;AACDE,WAAOf,GAAP,EAAWI,GAAX,EAAeC,IAAf,EAAoB;AAChB,YAAIW,UAAU,KAAKrB,KAAL,CAAWM,GAAX,CAAeR,QAAQM,MAAR,CAAeC,GAAf,CAAf,CAAd;AACA,YAAIe,SAASE,OAAOC,MAAP,CAAc,EAAd,EAAiBlB,IAAIO,IAArB,EAA0BS,OAA1B,CAAb;AACA,eAAO,KAAKrB,KAAL,CAAWoB,MAAX,CAAkBtB,QAAQM,MAAR,CAAeC,GAAf,CAAlB,EAAsCe,MAAtC,EACFN,IADE,CACGC,QAAO;AAACN,gBAAIO,IAAJ,CAASD,IAAT;AAAe,SAD1B,EAEFE,KAFE,CAEIC,KAAI;AAACR,iBAAKQ,CAAL;AAAS,SAFlB,CAAP;AAGH;AACDM,WAAOnB,GAAP,EAAWI,GAAX,EAAeC,IAAf,EAAoB;AAChB,eAAO,KAAKV,KAAL,CAAWwB,MAAX,CAAkB1B,QAAQM,MAAR,CAAeC,GAAf,CAAlB,EACFS,IADE,CACGW,WAAU;AAAChB,gBAAIiB,UAAJ,CAAe,GAAf;AAAqB,SADnC,EAEFT,KAFE,CAEIC,KAAI;AAACR,iBAAKQ,CAAL;AAAS,SAFlB,CAAP;AAGH;AAvCuB;kBAAPpB,O","file":"service.js","sourcesContent":["\nimport uuid from 'uuid';\nimport _ from 'lodash';\n\n\nexport default class Service{\n    constructor(store){\n        this.store = store;\n        _.bindAll(this,['save','all','get','update','delete']);\n    }\n    static id(){\n        return uuid.v4();\n    }\n    static pathId(req = {}){\n        return _.get(req.params,'id','');\n    }\n    save(req,res,next){\n        let newData = req.body;\n        _.set(newData,'id',Service.id());\n        return this.store.save(newData)\n            .then(data =>{res.json(data)})\n            .catch(e =>{next(e);})\n    }\n    all(req,res,next){\n        return this.store.all()\n            .then(data =>{res.json(data)})\n            .catch(e =>{next(e);});\n    }\n    get(req,res,next){\n        return this.store.get(Service.pathId(req))\n            .then(data =>{res.json(data)})\n            .catch(e =>{next(e);});\n    }\n    update(req,res,next){\n        let current = this.store.get(Service.pathId(req));\n        let update = Object.assign({},req.body,current);\n        return this.store.update(Service.pathId(req),update)\n            .then(data =>{res.json(data)})\n            .catch(e =>{next(e);});\n    }\n    delete(req,res,next){\n        return this.store.delete(Service.pathId(req))\n            .then(deleted =>{res.sendStatus(204);})\n            .catch(e =>{next(e);})\n    }\n}"]}